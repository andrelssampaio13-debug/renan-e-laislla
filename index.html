<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Renan & Laislla</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Site do casamento de Renan e Laislla com informa√ß√µes sobre o evento, galeria de fotos, lista de presentes, localiza√ß√£o e confirma√ß√£o de presen√ßa.">
  
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --rosa:#d88fa3;
  --dourado:#e6c76b;
  --cinza:#777;
}

*{box-sizing:border-box}
html{scroll-behavior:smooth}

body{
  margin: 0;
  font-family: 'Montserrat', Arial, sans-serif;
  font-weight: 400;
  color: #555;
  background: #fff;
}

/* ===== MENU ===== */
nav{
  position:sticky;
  top:0;
  background:#fff;
  border-bottom:1px solid #eee;
  z-index:1000;
  text-align:center;
}
nav a{
  display: inline-block;
  padding: 14px 12px;
  font-size: 14px;
  font-weight: 600;
  letter-spacing: 0.04em;
  text-decoration: none;
  color: #777;
  text-transform: uppercase;
}

nav a:hover{color:var(--rosa)}

/* ===== TOPO ===== */
.hero{
  text-align:center;
  padding:50px 20px 30px;
}

.hero img{
  width:260px;
  height:260px;
  object-fit:cover;
  border-radius:50%;
  border:6px solid #eee;
}

.hero h1{
  font-size:46px;
  letter-spacing:6px;
  font-weight:300;
  color:var(--rosa);
  margin:20px 0 5px;
}

.hero span{
  display:block;
  font-size:34px;
  color:var(--dourado);
}

.hero p{
  font-size:18px;
  color:#888;
}

/* ===== CONTAGEM ===== */
.countdown{
  background:var(--dourado);
  padding:70px 20px;
  text-align:center;
}

.countdown h2{
  color:#000;
  letter-spacing:6px;
  font-weight:300;
  margin-bottom:30px;
}

.time{
  display:flex;
  justify-content:center;
  gap:18px;
  flex-wrap:wrap;
}

.time div{
  background:#fff;
  padding:22px;
  border-radius:14px;
  min-width:120px;
}

.time span{
  display:block;
  font-size:36px;
  color:var(--rosa);
}

/* ===== TEXTO CONTAGEM ===== */
.texto-contagem{
  max-width:900px;
  margin:60px auto;
  text-align:center;
  color:#888;
  font-size:18px;
  line-height:1.9;
}

.texto-contagem .versiculo{
  color:var(--rosa);
  font-size:20px;
  margin-bottom:25px;
}

/* ===== SE√á√ïES ===== */
section{
  max-width:1000px;
  margin:80px auto;
  padding:0 20px;
  text-align:center;
}

section h2{
  font-weight: 600;
  letter-spacing: 0.18em;
  margin-bottom: 40px;
  color: #777;
  text-transform: uppercase;
}

/* ===== CASAL ===== */
.casal{
  display:flex;
  justify-content:center;
  gap:40px;
  margin-bottom:40px;
  flex-wrap:wrap;
}

.casal img{
  width:180px;
  height:180px;
  border-radius:50%;
  object-fit:cover;
}

.texto{
  font-size:20px;
  line-height:1.8;
  color:#888;
}

/* ===== CARROSSEL ===== */
.carousel{
  position:relative;
  max-width:900px;
  margin:40px auto;
  overflow:hidden;
}

.carousel-track{
  display:flex;
  transition:transform .6s ease;
}

.carousel-slide{
  min-width:100%;
  display:flex;
  justify-content:center;
  align-items:center;
}

.carousel-slide img{
  max-width:100%;
  max-height:520px;
  object-fit:contain;
  background:#fff;
}

.carousel button{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  background:rgba(216,143,163,.9);
  color:#fff;
  border:none;
  font-size:26px;
  width:44px;
  height:44px;
  border-radius:50%;
  cursor:pointer;
}

.prev{left:10px}
.next{right:10px}

/* ===== DOTS ===== */
.dots{
  display:flex;
  justify-content:center;
  margin-top:15px;
}

.dot{
  width:10px;
  height:10px;
  border-radius:50%;
  background:#ccc;
  margin:0 5px;
}

.dot.active{background:var(--dourado)}

/* ===== GRID ===== */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
}

.full-img{
  width:100%;
  max-height:400px;
  object-fit:cover;
  border-radius:8px;
}

/* ===== PRESENTES ===== */
.card{
  border:1px solid #eee;
  border-radius:8px;
  padding:20px;
}

.card img{
  width:100%;
  border-radius:6px;
}
 /* ===== TEXTO DOS CARDS ===== */
.card h3{
  font-weight: 400 !important; /* nome leve */
  font-size: 16px;
  color: #444;
  margin: 14px 0 6px;
}

.card p{
  font-weight: 700 !important; /* VALOR EM NEGRITO */
  font-size: 16px;
  color: #444;
  margin-bottom: 14px;
}

.card.escolhido {
  opacity: 0.55;
  position: relative;
}

.card.escolhido::after {
  content: "üéÅ Presente j√° escolhido";
  position: absolute;
  inset: 0;
  background: rgba(255,255,255,0.75);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: #555;
  font-size: 16px;
  text-align: center;
}

.card.escolhido button {
  display: none;
}

.qr img{
  width:180px;
}

/* ===== BOT√ïES ===== */
button{
  background:var(--rosa);
  color:#fff;
  border:none;
  padding:12px 25px;
  cursor:pointer;
  font-size:16px;
}
/* ===== MODAL PIX ===== */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.85);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 2147483647; /* m√°ximo poss√≠vel */
}

.modal-content {
  position: relative;
  z-index: 2147483647;
}

.modal-content {
  background: #fff;
  padding: 32px;
  border-radius: 14px;
  width: 90%;
  max-width: 420px;
  text-align: center;
  position: relative;
}

.modal .close {
  position: absolute;
  top: 10px;
  right: 14px;
  font-size: 26px;
  cursor: pointer;
}

/* ===== MAPA ===== */
iframe{
  width:100%;
  height:350px;
  border:0;
  border-radius:8px;
}

/* ===== MOBILE ===== */
@media(max-width:768px){
  .hero h1{font-size:34px}
  .carousel-slide img{max-height:320px}
  nav a{font-size:12px;padding:12px 8px}
}
  /* ===== MODAL DE COMPRA ===== */
.modal-compra {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  display: none; /* escondido por padr√£o */
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

.modal-compra.ativo {
  display: flex;
  justify-content: center;
  align-items: center;
}


.modal-box {
  background: #fff;
  padding: 32px;
  box-sizing: border-box;
  width: 90%;
  max-width: 420px;
  border-radius: 14px;
  text-align: center;
  position: relative;
}

.modal-fechar {
  position: absolute;
  top: 10px;
  right: 14px;
  border: none;
  background: none;
  font-size: 28px;
  cursor: pointer;
}

.modal-acoes {
  display: flex;
  flex-direction: column;
  gap: 14px;
  margin-top: 24px;
}

.btn-cartao {
  background: #009ee3;
  color: #fff;
  padding: 14px;
  border-radius: 8px;
  text-decoration: none;
  font-weight: bold;
  cursor: pointer;
}

.btn-pix {
  background: #00b894;
  color: #fff;
  padding: 14px;
  border-radius: 8px;
  border: none;
  font-weight: bold;
  cursor: pointer;
}
  
/* ===== BLOQUEIO TOTAL DA P√ÅGINA QUANDO MODAL ABERTO ===== */
/* ===== BLOQUEIO CORRETO PARA MODAL (SAFE MOBILE) ===== */
body.modal-aberto {
  overflow: hidden;
}

/* impede clique fora do modal sem travar layout */
body.modal-aberto > *:not(#pixModal) {
  pointer-events: none;
}

#pixModal {
  overscroll-behavior: contain;
}


</style>
</head>

<body>

<!-- MENU -->
<nav>
  <a href="#inicio">In√≠cio</a>
  <a href="#casal">O Casal</a>
  <a href="#galeria">Galeria</a>
  <a href="#recepcao">Recep√ß√£o</a>
  <a href="#informacoes">Informa√ß√µes</a>
  <a href="#cardapio">Card√°pio</a>
  <a href="#localizacao">Localiza√ß√£o</a>
  <a href="#presentes">Presentes</a>
  <a href="#rsvp">Confirma√ß√£o</a>
</nav>

<!-- TOPO -->
<div class="hero" id="inicio">
  <img src="imagens/foto18.jpg.jpeg">
  <h1>LAISLLA</h1>
  <span>+</span>
  <h1>RENAN</h1>
  <p>22 de agosto de 2026 ‚Ä¢ Cachoeira Grande</p>
</div>

<!-- CONTAGEM -->
<div class="countdown">
  <h2>CONTAGEM REGRESSIVA</h2>
  <div class="time">
    <div><span id="d">0</span>Dias</div>
    <div><span id="h">0</span>Horas</div>
    <div><span id="m">0</span>Minutos</div>
    <div><span id="s">0</span>Segundos</div>
  </div>
</div>

<div class="texto-contagem">
  <div class="versiculo">
    <strong>O que Deus uniu, ningu√©m o separe</strong><br>
    Mateus 19:6
  </div>

  Criamos esse site para compartilhar com voc√™s os detalhes da organiza√ß√£o do nosso casamento.
  Estamos muito felizes e contamos com a presen√ßa de todos no nosso grande dia!<br><br>

  Aqui voc√™s encontrar√£o trajes, estacionamento, etc.
  Ah, √© importante tamb√©m confirmar sua presen√ßa. Para isto contamos com sua ajuda clicando no menu
  ‚ÄúConfirme sua Presen√ßa‚Äù e preenchendo os dados necess√°rios.<br><br>

  Para nos presentear, escolha qualquer item da Lista de Casamento, escolha com o cora√ß√£o!
  Aguardamos voc√™s no nosso grande dia!
</div>

<!-- O CASAL -->
<section id="casal">
  <h2>O CASAL</h2>

  <div class="casal">
    <img src="imagens/foto19.jpg.jpeg">
    <img src="imagens/foto20.jpg.jpeg">
  </div>

  <div class="texto">
    <strong>Cada dia √© um cap√≠tulo novo na nossa hist√≥ria de amor</strong><br><br>
    Hist√≥rias de amor existem, e, √†s vezes, nem n√≥s mesmos acreditamos todo o tempo que j√° estamos juntos.
    Por√©m, o brilho intenso e apaixonado dos nossos olhares nos fazem lembrar o porqu√™ de chegarmos at√© aqui
    sem sentir tanto o tempo passar...<br><br>
    Vamos nos casar! Estamos preparando tudo com muito carinho para curtirmos cada momento com nossos amigos
    e familiares queridos!
  </div>
</section>

<!-- GALERIA -->
<div class="carousel" id="galeria">
  <div class="carousel-track">
    <div class="carousel-slide"><img src="imagens/foto1.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto2.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto3.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto4.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto5.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto6.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto7.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto8.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto9.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto10.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto11.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto12.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto13.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto14.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto15.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto16.jpg.jpeg"></div>
    <div class="carousel-slide"><img src="imagens/foto17.jpg.jpeg"></div>
  </div>

  <button class="prev">‚Äπ</button>
  <button class="next">‚Ä∫</button>
</div>

<div class="dots" id="dots"></div>

<!-- RECEP√á√ÉO -->
<section id="recepcao">
  <h2>RECEP√á√ÉO</h2>
  <img src="imagens/foto21.jpg.jpeg" class="full-img">
  <p class="texto">
    O casal convida para recep√ß√£o no dia 22 de agosto de 2026,
    na Cachoeira Grande, S√£o Paulo. Ser√° a partir de 14h.
    N√£o vai perder, n√©?
  </p>
</section>

<!-- INFORMA√á√ïES -->
<section id="informacoes">
  <h2>INFORMA√á√ïES GERAIS</h2>
  <p class="texto"><strong>Dresscode:</strong> Social / Passeio Completo</p>

  <div class="grid">
    <img src="imagens/foto22.jpg.jpeg" class="full-img">
    <img src="imagens/foto23.jpg.jpeg" class="full-img">
  </div>
</section>

<!-- CARD√ÅPIO -->
<section id="cardapio">
  <h2>CARD√ÅPIO</h2>
  <p class="texto">
    <strong>Card√°pio:</strong><br>
    Nossos queridos convidados ser√£o recebidos com um incr√≠vel welcome drinks
    (linda mesa de aperitivos) de p√≥s viagem para que n√£o fiquem com fome durante
    a nossa cerim√¥nia maravilhosa.<br><br>

    J√° no almo√ßo teremos uma maravilhosa feijoada bem brasileira e suculenta.
    (Teremos mais op√ß√µes para al√©rgicos e seletivos).
  </p>

  <div class="grid">
    <img src="imagens/foto24.jpg.jpeg" class="full-img">
    <img src="imagens/foto25.jpg.jpeg" class="full-img">
  </div>
</section>

<!-- LOCALIZA√á√ÉO -->
<section id="localizacao">
  <h2>LOCALIZA√á√ÉO</h2>
  <iframe src="https://www.google.com/maps?q=Cachoeira%20Grande%20SP&output=embed"></iframe>
  <p class="texto">
    Nosso dia especial ser√° em uma linda cachoeira no interior de S√£o Paulo
    na presen√ßa da natureza que o Senhor fez, teremos um dia maravilhoso entre fam√≠lia e amigos.
  </p>
</section>

<!-- LISTA DE PRESENTES (DIN√ÇMICA - PLANILHA) -->
<section id="presentes">
  <h2>LISTA DE PRESENTES</h2>
  
<!-- ORDENAR PRESENTES -->
<div class="ordenar-presentes" style="margin-bottom:30px;text-align:left">
  <label for="ordenarSelect"><strong>Ordenar lista por:</strong></label>
  <select id="ordenarSelect" style="margin-left:10px;padding:8px">
    <option value="menor">Menor pre√ßo</option>
    <option value="maior">Maior pre√ßo</option>
    <option value="az">A‚ÄìZ</option>
  </select>
</div>

  <div class="grid" id="listaPresentes"></div>

  <button id="verMais" style="margin-top:30px">Ver mais presentes</button>

  <p class="texto" style="margin-top:40px">
    <strong>Pix (CPF):</strong> 300.389.638-50
  </p>
</section>
  
<!-- CONFIRME SUA PRESEN√áA -->
<section id="rsvp">
  <h2>CONFIRME SUA PRESEN√áA</h2>

  <p class="texto">
    Sua presen√ßa √© muito importante para n√≥s üíï  
    Clique no bot√£o abaixo para confirmar.
  </p>

  <a 
    href="https://docs.google.com/forms/d/e/1FAIpQLScU7mQdPGp_Oy1N2eMSJPgL2apfoZNu1rGnb6z7sCNtkDo1WQ/viewform" 
    target="_blank" 
    rel="noopener"
  >
    <button>Confirmar Presen√ßa</button>
  </a>
</section>
<script>
/* ===== NORMALIZA VALOR (OBRIGAT√ìRIO) ===== */
function normalizarValor(valor) {
  if (!valor) return null;

  let v = valor.toString().trim();
  v = v.replace(",", ".");

  let num = parseFloat(v);
  if (isNaN(num)) return null;

  return num.toFixed(2); // sempre 2 casas
}
</script>

<script>
/* CONTAGEM */
const data=new Date("2026-08-22T14:00:00").getTime();
setInterval(()=>{
  const n=new Date().getTime();
  const d=data-n;
  if(d<0)return;
  document.getElementById("d").innerText=Math.floor(d/(1000*60*60*24));
  document.getElementById("h").innerText=Math.floor((d/(1000*60*60))%24);
  document.getElementById("m").innerText=Math.floor((d/(1000*60))%60);
  document.getElementById("s").innerText=Math.floor((d/1000)%60);
},1000);

/* CARROSSEL */
let i=0;
const track=document.querySelector(".carousel-track");
const slides=document.querySelectorAll(".carousel-slide");
const prev=document.querySelector(".prev");
const next=document.querySelector(".next");
const dotsC=document.getElementById("dots");

slides.forEach((_,x)=>{
  const d=document.createElement("div");
  d.className="dot"+(x===0?" active":"");
  d.onclick=()=>{i=x;update();}
  dotsC.appendChild(d);
});

function update(){
track.style.transform = `translateX(-${i*100}%)`;
  document.querySelectorAll(".dot").forEach((d,x)=>d.classList.toggle("active",x===i));
}

prev.onclick=()=>{i=(i-1+slides.length)%slides.length;update();}
next.onclick=()=>{i=(i+1)%slides.length;update();}
let autoSlide = setInterval(() => {
  if (!document.hidden) {
    next.onclick();
  }
}, 4000);

document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    clearInterval(autoSlide);
  } else {
    autoSlide = setInterval(() => next.onclick(), 4000);
  }
});

</script>
<script>
/* ===== LISTA DE PRESENTES VIA PLANILHA ===== */
const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vSUOq5Rmx6x6K9XZnuppxV6VnyJODPnEqBvrWtGYbBl_rp0uh3sczKGv7W1YzKL1-m2HH2R46MaCL6B/pub?output=csv&nocache=" + Date.now();
const API_URL = "https://script.google.com/macros/s/AKfycbyCOZkBILMeJ5QF64zqDSo9KDRv4Pq2N1iYrtZ0gvxhlscwlLkM14FggJ6KKhk5XwHl/exec";
let presentes = [];
let pagina = 0;
const porPagina = 15;

fetch(CSV_URL)
  .then(res => res.text())
  .then(csv => {
    const linhas = csv.split("\n").slice(1);
    presentes = linhas
    .map(l => {
  const c = [];
  let atual = "";
  let dentroAspas = false;

  for (let i = 0; i < l.length; i++) {
    const char = l[i];

    if (char === '"') {
      dentroAspas = !dentroAspas;
    } else if (char === "," && !dentroAspas) {
      c.push(atual);
      atual = "";
    } else {
      atual += char;
    }
  }
  c.push(atual);

 return {
  nome: c[0]?.replace(/(^"|"$)/g, ""),
  valor: c[1],
  tipo: c[2],
  ativo: c[3] === "sim",
  ordem: c[4],
  imagem: c[5] || "",
  status: (c[6] || "livre").trim()
};
})
 
      .filter(p => p.ativo);
    
    window.presentes = presentes;

    renderPresentes();
  });

function renderPresentes() {
  const cont = document.getElementById("listaPresentes");
  const fim = (pagina + 1) * porPagina;

  // separa valor livre do restante
  const presenteLivre = presentes.find(p => p.tipo === "livre");
  const outrosPresentes = presentes.filter(p => p.tipo !== "livre");

  // limpa lista ao renderizar primeira p√°gina
  if (pagina === 0) {
    cont.innerHTML = "";
    presentes.forEach(p => p.rendered = false);
  }

  // renderiza valor livre sempre primeiro
  if (presenteLivre && !presenteLivre.rendered) {
    renderCard(presenteLivre);
    presenteLivre.rendered = true;
  }

  // renderiza os demais respeitando pagina√ß√£o
  outrosPresentes.slice(0, fim).forEach(p => {
    if (p.rendered) return;
    renderCard(p);
    p.rendered = true;
  });
}
function renderCard(p) {
  const cont = document.getElementById("listaPresentes");

  const imagemPresente =
    p.imagem && p.imagem.trim() !== ""
      ? p.imagem
      : "imagens/presente-padrao.jpg.jpeg";

  const valorNormalizado = normalizarValor(p.valor);

  const textoValor =
    p.tipo === "livre" || !valorNormalizado
      ? "Valor livre"
      : "R$ " + valorNormalizado.replace(".", ",");

  const escolhido = p.status === "finalizado";

  cont.insertAdjacentHTML(
    "beforeend",
    `
    <div class="card ${escolhido ? "escolhido" : ""}">
      <img src="${imagemPresente}">
      <h3>${p.nome}</h3>
      <p>${textoValor}</p>
      ${
        escolhido
          ? ""
          : `<button onclick="iniciarPresente('${p.nome}','${p.valor}','${p.tipo}')">
               Presentear
             </button>`
      }
    </div>
    `
  );
}

document.getElementById("ordenarSelect").addEventListener("change", function(e) {
  const tipoOrdenacao = e.target.value;

  // reseta estado de renderiza√ß√£o
  presentes.forEach(p => p.rendered = false);
  pagina = 0;
  document.getElementById("listaPresentes").innerHTML = "";

  // fun√ß√£o segura para ordenar valores
  function valorSeguro(v) {
    const n = parseFloat(v);
    return isNaN(n) ? Infinity : n;
  }

  if (tipoOrdenacao === "menor") {
    presentes.sort((a, b) => valorSeguro(a.valor) - valorSeguro(b.valor));
  } 
  else if (tipoOrdenacao === "maior") {
    presentes.sort((a, b) => valorSeguro(b.valor) - valorSeguro(a.valor));
  } 
  else {
    presentes.sort((a, b) => a.nome.localeCompare(b.nome));
  }

  renderPresentes();
});

document.getElementById("verMais").onclick = () => {
  pagina++;
  renderPresentes();
};
/* ===== CONTROLE DO MODAL DE COMPRA ===== 

function abrirModalCompra() {
  const modal = document.getElementById("modal-compra");
  if (!modal) return;

  modal.classList.add("ativo");
  document.body.style.overflow = "hidden";
}

function fecharModalCompra() {
  const modal = document.getElementById("modal-compra");
  if (!modal) return;

  modal.classList.remove("ativo");
  document.body.style.overflow = "";
}

document.addEventListener("DOMContentLoaded", function () {
  const btnFechar = document.querySelector(".modal-fechar");
  if (btnFechar) {
    btnFechar.addEventListener("click", fecharModalCompra);
  }
});
  */
  /* ===== FUN√á√ïES AUXILIARES PIX (PREPARA√á√ÉO) ===== */

// c√°lculo CRC16 (padr√£o Banco Central)
function crc16(payload) {
  let crc = 0xFFFF;
  for (let i = 0; i < payload.length; i++) {
    crc ^= payload.charCodeAt(i) << 8;
    for (let j = 0; j < 8; j++) {
      crc = (crc & 0x8000) ? (crc << 1) ^ 0x1021 : crc << 1;
    }
  }
  return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, "0");
}
function normalizarPixTexto(texto) {
  return texto
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g, "")
    .replace(/[^A-Za-z0-9 ]/g, "")
    .toUpperCase()
    .trim();
}
function chavePresente(nome) {
  return "presente_" + nome
    .toLowerCase()
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g, "")
    .replace(/[^a-z0-9]/g, "_");
}
function iniciarPresente(nome, valor, tipo) {
  const chave = chavePresente(nome);

  if (localStorage.getItem(chave) === "finalizado") {
    alert("Este presente j√° foi escolhido üíï");
    return;
  }

  if (localStorage.getItem(chave) === "reservado") {
    alert("Este presente est√° sendo escolhido agora üòä");
    return;
  }

  // reserva tempor√°ria
  localStorage.setItem(chave, "reservado");

  abrirModal(nome, valor, tipo);
}

function gerarPixPayload({ chave, nome, cidade, valor }) {
  function campo(id, valor) {
    const tamanho = valor.length.toString().padStart(2, "0");
    return id + tamanho + valor;
  }

  const payloadSemCRC =
    campo("00", "01") +
    campo(
      "26",
      campo("00", "BR.GOV.BCB.PIX") +
      campo("01", chave)
    ) +
    campo("52", "0000") +
    campo("53", "986") +
    (valor ? campo("54", valor) : "") +
    campo("58", "BR") +
    campo("59", nome.substring(0, 25)) +
    campo("60", cidade.substring(0, 15)) +
    campo("62", "0503***");

  const crc = crc16(payloadSemCRC + "6304");

  return payloadSemCRC + "6304" + crc;
}

  /* ===== MODAL PIX ===== */
function abrirModal(nome, valor, tipo) {
document.body.classList.add("modal-aberto");
document.documentElement.style.overflow = "hidden";
  
  document.getElementById("modalTitulo").innerText = nome;

  const valorNumerico = tipo === "livre" ? null : valor;

  document.getElementById("modalValor").innerText =
    tipo === "livre"
      ? "Escolha o valor no seu app Pix üíï"
      : "Valor do presente: R$ " + valor;

const payload = gerarPixPayload({
  chave: "gosteieufalo@gmail.com",
  nome: normalizarPixTexto("RENAN E LAISLLA"),
  cidade: "SAO PAULO",
  valor: valorNumerico ? normalizarValor(valorNumerico) : null
});

  document.getElementById("qrPix").src =
    "https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=" +
    encodeURIComponent(payload);

  document.getElementById("pixCopiaCola").value = payload;

  document.getElementById("areaPix").style.display = "none";
  document.getElementById("pixModal").style.display = "flex";
}

function fecharModal() {
  const nome = document.getElementById("modalTitulo").innerText;

  if (nome) {
    fetch(API_URL, {
      method: "POST",
      body: JSON.stringify({
        acao: "liberar",
        nome: nome
      })
    });
  }

  document.body.classList.remove("modal-aberto");
  document.documentElement.style.overflow = "";
  document.getElementById("pixModal").style.display = "none";
}
  }

  document.body.classList.remove("modal-aberto");
  document.documentElement.style.overflow = "";
  document.getElementById("pixModal").style.display = "none";
}

const pixModal = document.getElementById("pixModal");

if (pixModal) {
  pixModal.onclick = function (e) {
    if (e.target === pixModal) {
      fecharModal();
    }
  };
}

</script>

 <!-- MODAL DE COMPRA -->
<!-- MODAL DE COMPRA DESATIVADO (N√ÉO USAR AGORA) --> 
<!--
<div id="modal-compra" class="modal-compra">
  <div class="modal-box">
    <button class="modal-fechar">√ó</button>

    <h2>Finalizar presente</h2>
    <p>Escolha a forma de pagamento</p>

    <div class="modal-acoes">
      <a href="#" class="btn-cartao">
        üí≥ Pagar com cart√£o
      </a>

      <button class="btn-pix">
        üü¶ Pagar com Pix
      </button>
    </div>
  </div>
</div>
  -->
<script>
  function abrirModalCompra() {
    document.getElementById("modal-compra").classList.add("ativo");
    document.body.style.overflow = "hidden";
  }

  function fecharModalCompra() {
    document.getElementById("modal-compra").classList.remove("ativo");
    document.body.style.overflow = "";
  }
function mostrarPix() {
  const nome = document.getElementById("modalTitulo").innerText;
  const chave = chavePresente(nome);

  // marca como presente finalizado
  localStorage.setItem(chave, "finalizado");

  document.getElementById("areaPix").style.display = "block";
}
function copiarPix() {
  const texto = document.getElementById("pixCopiaCola").value;

  if (!navigator.clipboard) {
    alert("Seu navegador n√£o suporta c√≥pia autom√°tica. Selecione e copie manualmente.");
    return;
  }

  navigator.clipboard.writeText(texto).then(() => {
    alert("C√≥digo Pix Copia e Cola copiado! Funciona em qualquer banco üíö");
  }).catch(() => {
    alert("N√£o foi poss√≠vel copiar automaticamente. Copie manualmente.");
  });
}

  // bot√£o X do modal
  document.addEventListener("DOMContentLoaded", function () {
    const btnFechar = document.querySelector(".modal-fechar");
    if (btnFechar) {
      btnFechar.addEventListener("click", fecharModalCompra);
    }
  });
</script>
 <!-- MODAL PIX -->
<div class="modal" id="pixModal">

  <div class="modal-content">

    <span class="close" onclick="fecharModal()">‚úï</span>

    <h3 id="modalTitulo"></h3>
    <p id="modalValor"></p>

    <div style="margin-top:20px;display:flex;flex-direction:column;gap:12px">

      <button onclick="mostrarPix()" style="background:#00b894">
        üü¢ Pagar com Pix
      </button>

      <a
        href="https://link.mercadopago.com.br/casamentorenanlaisla"
        target="_blank"
        class="btn-cartao"
        style="display:block; background:#009ee3; color:#fff; padding:14px; border-radius:8px; text-decoration:none; font-weight:bold"
      >
        üí≥ Pagar com cart√£o
      </a>

    </div>

    <!-- √ÅREA PIX -->
    <div class="qr" id="areaPix" style="display:none;margin-top:20px">

      <img id="qrPix" style="max-width:260px">

      <p style="margin-top:10px">
        <strong>Pix:</strong> 300.389.638-50
      </p>

      <p style="font-size:14px;color:#666;margin-top:10px">
        Funciona em qualquer banco üíö
      </p>

      <textarea
        id="pixCopiaCola"
        readonly
        style="width:100%;height:90px;margin-top:10px;padding:8px;font-size:12px"
      ></textarea>

      <button onclick="copiarPix()" style="margin-top:10px;background:#00b894">
        üìã Copiar c√≥digo Pix
      </button>

    </div><!-- /areaPix -->

  </div><!-- /modal-content -->

</div><!-- /pixModal -->
<!-- ===== PAINEL ADMIN (OCULTO) ===== -->
<div id="adminPainel" style="display:none;position:fixed;bottom:20px;right:20px;z-index:999999;background:#fff;border:1px solid #ccc;padding:15px;border-radius:10px;max-width:300px">
  <strong>üîí Admin ‚Äì Presentes</strong>
  <div id="adminLista" style="margin-top:10px;font-size:14px"></div>
</div>
<script>
/* ===== ADMIN SECRETO ===== */
document.addEventListener("keydown", function (e) {
  // combina√ß√£o secreta: Ctrl + Alt + A
  if (e.ctrlKey && e.altKey && e.key.toLowerCase() === "a") {
    const senha = prompt("√Årea restrita. Digite a senha:");

    if (senha === "admin123") {
      abrirPainelAdmin();
    } else {
      alert("Senha incorreta");
    }
  }
});

function abrirPainelAdmin() {
  const painel = document.getElementById("adminPainel");
  const lista = document.getElementById("adminLista");

  lista.innerHTML = "";

  for (let i = 0; i < localStorage.length; i++) {
    const chave = localStorage.key(i);

    if (chave.startsWith("presente_") && localStorage.getItem(chave) === "finalizado") {
      const nome = chave.replace("presente_", "").replace(/_/g, " ");

      const item = document.createElement("div");
      item.style.marginBottom = "8px";

      item.innerHTML = `
        üéÅ ${nome}
        <button style="margin-left:8px;font-size:12px" onclick="desmarcarPresente('${chave}')">
          Desmarcar
        </button>
      `;

      lista.appendChild(item);
    }
  }

  painel.style.display = "block";
}

function desmarcarPresente(chave) {
  if (confirm("Deseja liberar este presente?")) {
    localStorage.removeItem(chave);
    alert("Presente liberado");
    location.reload();
  }
}
</script>

</body>
</html>
